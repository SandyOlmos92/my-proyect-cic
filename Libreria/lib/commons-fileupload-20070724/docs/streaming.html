<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>The Streaming API - FileUpload</title><style type="text/css" media="all">
          @import url("./style/maven-base.css");
          
          @import url("./style/maven-theme.css");@import url("./style/project.css");</style><link rel="stylesheet" href="./style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta></head><body class="composite"><div id="banner"><a href="http://jakarta.apache.org" id="organizationLogo"><img alt="The Apache Software Foundation" src="http://jakarta.apache.org/images/original-jakarta-logo.gif"></img></a><a href="http://jakarta.apache.org/commons/fileupload/" id="projectLogo"><img alt="FileUpload" src="./images/logo.png"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 24 July 2007
                <span class="separator">|</span> Doc for  1.3-SNAPSHOT
                </div><div class="xright">
        
        <a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Jakarta Commons</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuCommons_FileUpload"><h5>Commons FileUpload</h5><ul><li class="none"><a href="index.html">Overview</a></li><li class="none"><a href="using.html">User guide</a></li><li class="none"><strong><a href="streaming.html">Streaming API</a></strong></li><li class="none"><a href="faq.html">FAQ</a></li><li class="none"><a href="apidocs/index.html">Javadoc</a></li><li class="none"><a href="mail-lists.html">Mailing lists</a></li><li class="none"><a href="team-list.html">Team</a></li><li class="none"><a href="tasks.html">Tasks</a></li><li class="none"><a href="cvs-usage.html">SVN repository</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="index.html">About</a></li><li class="collapsed"><a href="project-info.html">Project Info</a></li><li class="collapsed"><a href="maven-reports.html">Project Reports</a></li><li class="none"><a href="http://jakarta.apache.org/commons/charter.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menuCommons"><h5>Commons</h5><ul><li class="none"><a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Home</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/components.html" class="externalLink" title="External Link">Components</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/sandbox/index.html" class="externalLink" title="External Link">Sandbox</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/dormant/index.html" class="externalLink" title="External Link">Dormant</a></li><li class="none"><a href="http://jakarta.apache.org/commons/volunteering.html" class="externalLink" title="External Link">Volunteering</a></li><li class="none"><a href="http://jakarta.apache.org/commons/patches.html" class="externalLink" title="External Link">Contributing Patches</a></li><li class="none"><a href="http://jakarta.apache.org/commons/building.html" class="externalLink" title="External Link">Building Components</a></li><li class="none"><a href="http://jakarta.apache.org/commons/releases/index.html" class="externalLink" title="External Link">Releasing Components</a></li><li class="none"><a href="http://wiki.apache.org/jakarta-commons/FrontPage" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="./images/logos/maven-feather.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Why_Streaming_"></a><h2>Why Streaming?</h2>
    <p>
      The traditional API, which is described in the <a href="using.html">User
      Guide</a>, assumes, that file items must be stored somewhere, before
      they are actually accessable by the user. This approach is convenient,
      because it allows easy access to an items contents. On the other hand,
      it is memory and time consuming.
    </p>
    <p>
      The streaming API allows you to trade a little bit of convenience for
      optimal performance and and a low memory profile. Additionally, the
      API is more lightweight, thus easier to understand.
    </p>
  </div><div class="section"><a name="How_it_works"></a><h2>How it works</h2>
    <p>
      Again, the <code>FileUpload</code> class is used for accessing the
      form fields and fields in the order, in which they have been sent
      by the client. However, the <code>FileItemFactory</code> is completely
      ignored.
    </p>
  </div><div class="section"><a name="Parsing_the_request"></a><h2>Parsing the request</h2>
    <p>
      First of all, do not forget to ensure, that a request actually is a
      a file upload request. This is typically done using the same static
      method, which you already know from the traditional API.
    </p>

    <div class="source"><pre>// Check that we have a file upload request
boolean isMultipart = ServletFileUpload.isMultipartContent(request);</pre></div>
  
    <p>
      Now we are ready to parse the request into its constituent items. Here's
      how we do it:
    </p>

    <div class="source"><pre>
// Create a new file upload handler
ServletFileUpload upload = new ServletFileUpload();

// Parse the request
FileItemIterator iter = upload.getItemIterator(request);
while (iter.hasNext()) {
    FileItemStream item = iter.next();
    String name = item.getFieldName();
    InputStream stream = item.openStream();
    if (item.isFormField()) {
        System.out.println("Form field " + name + " with value "
            + Streams.asString(stream) + " detected.");
    } else {
        System.out.println("File field " + name + " with file name "
            + item.getName() + " detected.");
        // Process the input stream
        ...
    }
}</pre></div>
  
    <p>
      That's all that's needed. Really!
    </p>
  </div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2002-2007, The Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>